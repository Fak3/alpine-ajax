<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Loading Indicator | Alpine AJAX</title>
  <meta name="description" content="Alpine AJAX">
  <meta name="generator" content="Eleventy v2.0.0">
  <link rel="stylesheet" href="https://unpkg.com/@exampledev/new.css@1.1.3/new.css">
  <link rel="stylesheet" href="https://unpkg.com/prism-themes@1.9.0/themes/prism-a11y-dark.min.css">
  <link rel="stylesheet" href="/alpine-ajax/css/main.css">
  <script>!function(e){"function"==typeof define&&define.amd?define(e):e()}((function(){"use strict";var e;e=null,document.addEventListener("click",(function(t){t.target.closest&&(e=t.target.closest("button, input[type=submit], input[type=image]"))}),!0),document.addEventListener("submit",(function(t){if(!("submitter"in t)){var n=[document.activeElement,e];e=null;for(var r=0;r<n.length;r++){var i=n[r];if(i&&i.form&&i.matches("button, input[type=button], input[type=image]"))return void(t.submitter=i)}t.submitter=t.target.querySelector("button, input[type=button], input[type=image]")}}),!0);class t{el=void 0;constructor(e){this.el=e}traversals={first:"firstElementChild",next:"nextElementSibling",parent:"parentElement"};nodes(){return this.traversals={first:"firstChild",next:"nextSibling",parent:"parentNode"},this}first(){return this.teleportTo(this.el[this.traversals.first])}next(){return this.teleportTo(this.teleportBack(this.el[this.traversals.next]))}before(e){return this.el[this.traversals.parent].insertBefore(e,this.el),e}replace(e){return this.el[this.traversals.parent].replaceChild(e,this.el),e}append(e){return this.el.appendChild(e),e}teleportTo(e){return e&&e._x_teleport?e._x_teleport:e}teleportBack(e){return e&&e._x_teleportBack?e._x_teleportBack:e}}function n(e){return new t(e)}let r=()=>{},i=()=>{};async function a(e,t,a){let l,u,s,d,c,f,p,m,h,w,b;function v(e){if(b)return i((e||"").replace("\n","\\n"),l,u),new Promise((e=>r=()=>e()))}async function y(e,t){if(function(e,t){return e.nodeType!=t.nodeType||e.nodeName!=t.nodeName||x(e)!=x(t)}(e,t)){let r=function(e,t){if(o(p,e))return;let r=t.cloneNode(!0);if(o(h,r))return;n(e).replace(r),m(e),w(r)}(e,t);return await v("Swap elements"),r}let r=!1;if(!o(c,e,t,(()=>r=!0))){if(window.Alpine&&function(e,t,n){if(1!==e.nodeType)return;e._x_dataStack&&window.Alpine.clone(e,t)}(e,t),3===(i=t).nodeType||8===i.nodeType)return await async function(e,t){let n=t.nodeValue;e.nodeValue!==n&&(e.nodeValue=n,await v("Change text node to: "+n))}(e,t),void f(e,t);var i;r||await async function(e,t){if(e._x_isShown&&!t._x_isShown)return;if(!e._x_isShown&&t._x_isShown)return;let n=Array.from(e.attributes),r=Array.from(t.attributes);for(let r=n.length-1;r>=0;r--){let i=n[r].name;t.hasAttribute(i)||(e.removeAttribute(i),await v("Remove attribute"))}for(let t=r.length-1;t>=0;t--){let n=r[t].name,i=r[t].value;e.getAttribute(n)!==i&&(e.setAttribute(n,i),await v(`Set [${n}] attribute to: "${i}"`))}}(e,t),f(e,t),await async function(e,t){let r=e.childNodes;g(t.childNodes);let i=g(r),a=n(t).nodes().first(),l=n(e).nodes().first(),u={};for(;a;){let t=x(a),r=x(l);if(!l){if(!t||!u[t]){let t=E(a,e)||{};await v("Add element: "+(t.outerHTML||t.nodeValue)),a=n(a).nodes().next();continue}{let r=u[t];n(e).append(r),l=r,await v("Add element (from key)")}}if(d){let e=n(a).next(),t=!1;for(;!t&&e;)l.isEqualNode(e)&&(t=!0,l=A(a,l),r=x(l),await v("Move element (lookahead)")),e=n(e).next()}if(t!==r){if(!t&&r){u[r]=l,l=A(a,l),u[r].remove(),l=n(l).nodes().next(),a=n(a).nodes().next(),await v('No "to" key');continue}if(t&&!r&&i[t]&&(l=n(l).replace(i[t]),await v('No "from" key')),t&&r){u[r]=l;let e=i[t];if(!e){u[r]=l,l=A(a,l),u[r].remove(),l=n(l).next(),a=n(a).next(),await v("Swap elements with keys");continue}l=n(l).replace(e),await v('Move "from" key')}}let o=l&&n(l).nodes().next();await y(l,a),a=a&&n(a).nodes().next(),l=o}let s=[];for(;l;)o(p,l)||s.push(l),l=n(l).nodes().next();for(;s.length;){let e=s.shift();e.remove(),await v("remove el"),m(e)}}(e,t)}}function x(e){return e&&1===e.nodeType&&s(e)}function g(e){let t={};return e.forEach((e=>{let n=x(e);n&&(t[n]=e)})),t}function E(e,t){if(!o(h,e)){let r=e.cloneNode(!0);return n(t).append(r),w(r),r}return null}function A(e,t){if(!o(h,e)){let r=e.cloneNode(!0);return n(t).before(r),w(r),r}return t}return function(e={}){let t=()=>{};c=e.updating||t,f=e.updated||t,p=e.removing||t,m=e.removed||t,h=e.adding||t,w=e.added||t,s=e.key||(e=>e.getAttribute("key")),d=e.lookahead||!1,b=e.debug||!1}(a),l=e,u=function(e){const t=document.createElement("template");return t.innerHTML=e,t.content.firstElementChild}(t),window.Alpine&&window.Alpine.closestDataStack&&!e._x_dataStack&&(u._x_dataStack=window.Alpine.closestDataStack(e),u._x_dataStack&&window.Alpine.clone(e,u)),await v(),await y(e,u),l=void 0,u=void 0,e}function o(e,...t){let n=!1;return e(...t,(()=>n=!0)),n}function l(e){e.directive("ajax",((e,{},{cleanup:t})=>{u(e);let n=function(e){let t=t=>{let n=t.target;if(d(n))return;t.preventDefault(),t.stopPropagation();let r=(n.getAttribute("method")||"GET").toUpperCase(),i=n.getAttribute("action")||window.location.href,a=new FormData(n),o=t.submitter,l=!1;o&&(l=o===document.activeElement,o.setAttribute("disabled",""),o.name&&a.append(o.name,o.value)),f(e,n,r,i,a,o,l)};return e.addEventListener("submit",t),()=>e.removeEventListener("submit",t)}(e),r=function(e){let t=t=>{let n=t.target,r=n.dataset.action;r&&(t.preventDefault(),t.stopPropagation(),f(e,n,"GET",r,null,null))};return e.addEventListener("click",t),()=>e.removeEventListener("click",t)}(e);t((()=>{n(),r()}))})),e.directive("load",((e,{value:t,modifiers:n,expression:r},{cleanup:i})=>{if(!t&&!e.dataset.source)return p(e,"GET",r);if(!t&&n.length){let t=n[0].split("ms")[0];setTimeout((()=>p(e,"GET",r)),t)}let a=function(e,t,n){let r=()=>p(e,"GET",n);return window.addEventListener(t,r),()=>window.removeEventListener(t,r)}(e,t,r);i((()=>{a()}))}))}function u(e){if(!e.hasAttribute("data-action"))return s(e)?c(e):void e.querySelectorAll("[href]:not([noajax]):not([data-action])").forEach((e=>{s(e)&&!d(e)&&c(e)}))}function s(e){return"A"===e.tagName&&e.getAttribute("href")&&0!==e.getAttribute("href").indexOf("#")&&e.hostname===location.hostname}function d(e){return e.closest("[x-ajax],[noajax]").hasAttribute("noajax")}function c(e){e.setAttribute("role","button"),e.dataset.action=e.getAttribute("href"),e.tabIndex=0,e.removeAttribute("href"),e.addEventListener("keydown",(e=>32===e.keyCode&&e.target.click()))}async function f(e,t,n,r,i=null,a=null,o=!1){let l=t.closest("[x-target]"),u=new Set(l?l.getAttribute("x-target").split(" ").filter((e=>e)):[e.id]);u.forEach((e=>{let t=document.getElementById(e);t&&t.setAttribute("aria-busy","true")}));let s=await m(t,n,r,i);s.body&&(a&&(a.removeAttribute("disabled"),o&&a.focus()),w(u,s.body,s.url))}async function p(e,t,n){let r=await m(e,t,n);r.body&&w(new Set([e.id]),r.body,r.url,!1)}async function m(e,t,n,r=null){var i;if(!h(e,"ajax:before"))return!1;if("GET"===t&&r){let e=Array.from(r.entries()).filter((([e,t])=>""!==t||null!==t));if(e.length){let t=n.split("#");(n=t[0]).includes("?")?n+="&":n+="?",n+=new URLSearchParams(e);let r=t[1];r&&(n+="#"+r)}r=null}let a=null===(i=e.closest("[data-source]"))||void 0===i?void 0:i.dataset.source;try{let i=await fetch(n,{headers:{"X-Alpine-Request":"true"},referrer:a,method:t,body:r});if(!i.ok){let e=new Error("Network response was not OK.");throw e.response=i,e}return h(e,"ajax:success",i),h(e,"ajax:after",i),{url:i.url,body:await i.text()}}catch(t){let n=t.response;if(!n)throw t;return h(e,"ajax:error",n),h(e,"ajax:after",n),{url:n.url,body:await n.text()}}}function h(e,t,n={}){return e.dispatchEvent(new CustomEvent(t,{detail:n,bubbles:!0,composed:!0,cancelable:!0}))}function w(e,t,n,r=!0){r&&document.querySelectorAll("[x-sync]").forEach((t=>{t.id&&e.add(t.id)}));let i=function(e){return document.createRange().createContextualFragment(e)}(t);e.forEach((async e=>{let t=i.getElementById(e);t&&(t.dataset.source=n,await a(document.getElementById(e),t.outerHTML),u(document.getElementById(e)))}))}a.step=()=>r(),a.log=e=>{i=e},document.addEventListener("alpine:initializing",(()=>{l(window.Alpine)}))}));
</script>
  <script defer="" src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"></script>
  <style>
  #demo-server-info {
    position: fixed;
    bottom: 0;
    right: .5rem;
    left: .5rem;
    border-bottom-right-radius: 0;
    border-bottom-left-radius: 0;
    box-shadow: 0 10px 15px -3px var(--shadow), 0 4px 6px -4px var(--shadow);
    margin: 0;
  }

  #demo-canvas {
    margin-bottom: calc(40vh + 4rem);
  }

  #demo-activity {
    display: flex;
    flex-wrap: wrap;
    gap: 2rem;
    height: 40vh;
    overflow: scroll;
  }

  #demo-activity> :first-child {
    flex-grow: 1;
  }

  #demo-activity> :last-child {
    flex-basis: 0;
    flex-grow: 999;
    min-inline-size: 50%;
    margin-top: .4rem;
  }

  #demo-activity [aria-current="step"] button {
    font-weight: 700;
  }

  #demo-activity dl>div:not(:first-child) dd::before {
    content: '';
  }

  #demo-activity dl>div:first-child {
    display: flex;
    gap: .4rem;
    align-items: center;
    margin-bottom: .4rem;
  }

  #demo-timeline button {
    padding: 0;
    border: none;
    background: transparent;
    color: var(--nc-lk-1);
    text-decoration: underline;
  }

  #demo-timeline button:hover,
  #demo-timeline button:focus {
    color: var(--nc-lk-2);
  }

</style>
  <script>
  function server(routes) {
    window.requestCount = 0
    window.fetch = async (url, options) => {
      let method = options.method.toUpperCase()
      console.log(method, url, options)
      let data = options.body || new FormData
      let params = new URLSearchParams(url.split('?')[1])
      let body = await Promise.resolve(routes[routeKey(method, url)](data, params))
      window.requestCount++
      logActivity(window.requestCount, method, url, formatData(data), body);
      return Promise.resolve({
        ok: true,
        url,
        text: () => Promise.resolve(body)
      })
    }

    function routeKey(method, url) {
      let name = url.split('?')[0]
      return `${method} ${name}`
    }

    function formatData(formData) {
      let params = {};
      formData.forEach((value, key) => {
        if (!params.hasOwnProperty(key)) {
          params[key] = value;
          return;
        }
        if (!Array.isArray(params[key])) {
          params[key] = [params[key]];
        }
        params[key].push(value);
      })

      return params
    }

    return {
      get: async (url) => {
        let content = await new Promise(resolve => resolve(routes[`GET ${url}`](new FormData, new URLSearchParams)))
        let canvas = document.getElementById("demo-canvas");
        if (canvas) {
          canvas.innerHTML = content;
        }
        window.requestCount++
        logActivity(window.requestCount, 'GET', url, {}, content);
      }
    }
  }

  function showTimelineEntry(id) {
    Array.from(document.getElementById("demo-current-request").children).forEach(child => {
      if (child.id == id) {
        child.removeAttribute('hidden');
      } else {
        child.setAttribute('hidden', true);
      }
    })
    Array.from(document.getElementById("demo-timeline").children).forEach(child => {
      if (child.id == id + "-link") {
        child.setAttribute('aria-current', 'step');
      } else {
        child.removeAttribute('aria-current');
      }
    })
  }

  function logActivity(id, method, url, params, body) {
    document.getElementById("request-count").innerHTML = window.requestCount
    document.getElementById("demo-timeline").insertAdjacentHTML("afterbegin", `<li id="${id}-link"><button onclick="showTimelineEntry('${id}')" style="cursor: pointer">${method} ${url}</a></li>`);
    let bodyDiv = `<dl id="${id}">
      <div><dt>Request</dt><dd>${method} ${url}</dd></div>
      <div><dt>Parameters</dt><dd><pre class="language-html"><code class="language-html">${JSON.stringify(params)}</code></pre></dd></div>
      <div><dt>Response</dt><dd><pre class="language-html"><code class="language-html">${escapeHtml(body)}</code></pre></dd></div>
    </dl>`;
    document.getElementById("demo-current-request").insertAdjacentHTML("afterbegin", bodyDiv);
    showTimelineEntry(id);
    // Prism.highlightAll();
  }

  function escapeHtml(string) {
    let pre = document.createElement('pre');
    let text = document.createTextNode(string);
    pre.appendChild(text);
    return pre.innerHTML;
  }
</script>
</head>

<body>
  <a href="#main">Skip to content</a>
  <header>
    <a href="/alpine-ajax/" aria-current="">Alpine Ajax</a>
    <nav aria-label="Site">
      <ul role="list">
        <a href="/alpine-ajax/reference" aria-current="">Reference</a>
        <a href="/alpine-ajax/examples" aria-current="">Examples</a>
        <a href="https://github.com/imacrayon/alpine-ajax">GitHub</a>
      </ul>
    </nav>
  </header>
  <main id="main"><h1 id="loading-indicator" tabindex="-1">Loading Indicator <a class="direct-link" href="#loading-indicator" aria-hidden="true">#</a></h1>

<p>This example shows how you can use a little CSS to create a nice looking loading indicator that will appear while AJAX requests are in progress.</p>
<p>We start with a simple card that contains a button. When the button is clicked, a <code>GET</code> request is issued to retrieve a table of contact information.</p>
<pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>card<span class="token punctuation">"</span></span> <span class="token attr-name">x-data</span><span class="token punctuation">></span></span><br>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>table<span class="token punctuation">"</span></span> <span class="token attr-name">x-ajax</span><span class="token punctuation">></span></span><br>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/contacts<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Load Contacts<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span><br>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><br><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></code></pre>
<p>The contact table could take a while to fetch if it's large and it would be helpful to indicate to our users that the app is processing their request.</p>
<p>Fortunately, Alpine AJAX adds <code>aria-busy=&quot;true&quot;</code> to AJAX targets while a request is processing. We can can use this attribute in our CSS to automatically show and hide a loading indicator:</p>
<pre class="language-css"><code class="language-css"><span class="token selector">[aria-busy]</span> <span class="token punctuation">{</span><br>  <span class="token property">--loading-size</span><span class="token punctuation">:</span> 64px<span class="token punctuation">;</span><br>  <span class="token property">--loading-stroke</span><span class="token punctuation">:</span> 6px<span class="token punctuation">;</span><br>  <span class="token property">--loading-duration</span><span class="token punctuation">:</span> 1s<span class="token punctuation">;</span><br>  <span class="token property">opacity</span><span class="token punctuation">:</span> .75<br><span class="token punctuation">}</span><br><span class="token selector">[aria-busy]:before</span> <span class="token punctuation">{</span><br>  <span class="token property">content</span><span class="token punctuation">:</span> <span class="token string">''</span><span class="token punctuation">;</span><br>  <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span><br>  <span class="token property">top</span><span class="token punctuation">:</span> 50%<span class="token punctuation">;</span><br>  <span class="token property">left</span><span class="token punctuation">:</span> 50%<span class="token punctuation">;</span><br>  <span class="token property">width</span><span class="token punctuation">:</span> <span class="token function">var</span><span class="token punctuation">(</span>--loading-size<span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token property">height</span><span class="token punctuation">:</span> <span class="token function">var</span><span class="token punctuation">(</span>--loading-size<span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token property">margin-top</span><span class="token punctuation">:</span> <span class="token function">calc</span><span class="token punctuation">(</span><span class="token function">var</span><span class="token punctuation">(</span>--loading-size<span class="token punctuation">)</span> / 2 * -1<span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token property">margin-left</span><span class="token punctuation">:</span> <span class="token function">calc</span><span class="token punctuation">(</span><span class="token function">var</span><span class="token punctuation">(</span>--loading-size<span class="token punctuation">)</span> / 2 * -1<span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token property">border</span><span class="token punctuation">:</span> <span class="token function">var</span><span class="token punctuation">(</span>--loading-stroke<span class="token punctuation">)</span> solid <span class="token function">rgba</span><span class="token punctuation">(</span>0<span class="token punctuation">,</span> 0<span class="token punctuation">,</span> 0<span class="token punctuation">,</span> 0.15<span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token property">border-radius</span><span class="token punctuation">:</span> 50%<span class="token punctuation">;</span><br>  <span class="token property">border-top-color</span><span class="token punctuation">:</span> <span class="token function">rgba</span><span class="token punctuation">(</span>0<span class="token punctuation">,</span> 0<span class="token punctuation">,</span> 0<span class="token punctuation">,</span> 0.5<span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token property">animation</span><span class="token punctuation">:</span> rotate <span class="token function">calc</span><span class="token punctuation">(</span><span class="token function">var</span><span class="token punctuation">(</span>--loading-duration<span class="token punctuation">)</span><span class="token punctuation">)</span> linear infinite<span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><span class="token atrule"><span class="token rule">@keyframes</span> rotate</span> <span class="token punctuation">{</span><br>  <span class="token selector">100%</span> <span class="token punctuation">{</span> <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">rotate</span><span class="token punctuation">(</span>360deg<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre>
<style>
  [aria-busy] {
    --loading-size: 64px;
    --loading-stroke: 6px;
    --loading-duration: 1s;
    position: relative;
    opacity: .75
  }
  [aria-busy]:before {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    width: var(--loading-size);
    height: var(--loading-size);
    margin-top: calc(var(--loading-size) / 2 * -1);
    margin-left: calc(var(--loading-size) / 2 * -1);
    border: var(--loading-stroke) solid rgba(0, 0, 0, 0.15);
    border-radius: 50%;
    border-top-color: rgba(0, 0, 0, 0.5);
    animation: rotate calc(var(--loading-duration)) linear infinite;
  }
  @keyframes rotate {
    100% { transform: rotate(360deg); }
  }

  #card {
    box-shadow: 0 10px 15px -3px var(--shadow), 0 4px 6px -4px var(--shadow);
    padding: 1rem;
    border-radius: .5rem;
    display: flex;
    justify-content: center;
    align-items: flex-start;
  }

  #table {
    margin-bottom: 0;
    min-height: 164px
  }

</style>
<script>
  document.addEventListener('DOMContentLoaded', () => {
    window.server({
      'GET /dashboard': () => dashboard(),
      'GET /contacts': () => new Promise(resolve => {
        setTimeout(() => resolve(contacts()), 2000)
      }),
    }).get('/dashboard')
  })

  function dashboard() {
    return `<div id="card" x-data>
  <div id="table" x-ajax>
    <a href="/contacts">Load Contacts</a>
  </div>
</div>`
  }

  function contacts(rows) {
    return `<table id="table">
  <thead>
    <tr>
      <th scope="col">Name</th>
      <th scope="col">Email</th>
      <th scope="col">Status</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Finn</td>
      <td>fmertins@candykingdom.gov</td>
      <td>Active</td>
    </tr>
    <tr>
      <td>Jake</td>
      <td>jake@candykingdom.gov</td>
      <td>Inactive</td>
    </tr>
    <tr>
      <td>BMO</td>
      <td>bmo@moco.com</td>
      <td>Inactive</td>
    </tr>
    <tr>
      <td>Marceline</td>
      <td>marceline@vampirequeen.me</td>
      <td>Active</td>
    </tr>
  </tbody>
</table>`
  }
</script>

<h2 id="demo" tabindex="-1">Demo <a class="direct-link" href="#demo" aria-hidden="true">#</a></h2>

<noscript>
  <strong>This demo would normally function without JavaScript enabled</strong>. However, this website is static and
  mocks HTTP responses using JavaScript instead of interacting with a real server, so you will need to enable
  JavaScript to view this demo.
</noscript>
<div id="demo-canvas"></div>
<details id="demo-server-info">
  <summary>Server Requests (<span id="request-count"></span>)</summary>
  <div id="demo-activity">
    <div>
      <ol id="demo-timeline" reversed="">
      </ol>
    </div>
    <div id="demo-current-request">
    </div>
  </div>
</details>




</main>



</body>
</html>