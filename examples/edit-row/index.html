<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Edit Row | Alpine AJAX</title>
  <meta name="description" content="Alpine AJAX">
  <meta name="generator" content="Eleventy v2.0.1">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prism-themes@1.9.0/themes/prism-a11y-dark.min.css">
  <link rel="stylesheet" href="/alpine-ajax/css/main.css?id=3">
  <style>#example {
    overflow-x: auto;
    padding: 1rem;
    margin: -1rem;
    margin-bottom: calc(40vh + 4rem);
    max-width: 100%;
  }

  #server_info {
    position: fixed;
    bottom: 0;
    right: .5rem;
    left: .5rem;
    border-bottom-right-radius: 0;
    border-bottom-left-radius: 0;
    box-shadow: 0 10px 15px -3px var(--shadow), 0 4px 6px -4px var(--shadow);
    padding: .88rem 1rem;
    margin: 0;
  }

  #server_activity {
    display: flex;
    flex-wrap: wrap;
    gap: 2rem;
    height: 40vh;
    overflow: scroll;
  }

  #server_activity> :first-child {
    flex-grow: 1;
    position: relative;
  }

  #server_activity> :last-child {
    flex-basis: 0;
    flex-grow: 999;
    min-inline-size: 50%;
    margin-top: .4rem;
  }

  #server_activity [aria-current="step"] button {
    font-weight: 700;
  }

  #server_activity dl>div:not(:first-child) dd::before {
    content: '';
  }

  #server_activity dl>div:first-child {
    display: flex;
    gap: .4rem;
    align-items: center;
    margin-bottom: .4rem;
  }

  #server_timeline {
    position: sticky;
    top: 0;
  }

  #server_timeline button {
    padding: 0;
    border: none;
    background: transparent;
    color: var(--nc-lk-1);
    text-decoration: underline;
  }

  #server_timeline button:hover,
  #server_timeline button:focus {
    color: var(--nc-lk-2);
  }</style>
  
  <script defer="" src="/alpine-ajax/js/main.js"></script>
  <script>function example(action) {
    let requestCount = 1
    document.addEventListener('DOMContentLoaded', () => {
      window.fetch(action)
        .then(response => response.text())
        .then(html => document.getElementById('example').innerHTML = html)
    })
    document.body.addEventListener('server:response', (event) => {
      logActivity(requestCount++, event.detail.method, event.detail.url, event.detail.data, event.detail.body)
    })
  }

  function showTimelineEntry(id) {
    Array.from(document.getElementById("server_view").children).forEach(child => {
      if (child.id == id) {
        child.removeAttribute('hidden');
      } else {
        child.setAttribute('hidden', true);
      }
    })
    Array.from(document.getElementById("server_timeline").children).forEach(child => {
      if (child.id == id + "-link") {
        child.setAttribute('aria-current', 'step');
      } else {
        child.removeAttribute('aria-current');
      }
    })
  }

  function logActivity(id, method, url, params, body) {
    document.getElementById("server_request_count").innerHTML = id
    document.getElementById("server_timeline").insertAdjacentHTML("afterbegin", `<li id="${id}-link"><button onclick="showTimelineEntry('${id}')" style="cursor: pointer">${method} ${url}</a></li>`);
    let bodyDiv = `<dl id="${id}">
    <div><dt>Request</dt><dd>${method} ${url}</dd></div>
    <div><dt>Parameters</dt><dd><pre class="language-json"><code class="language-json">${JSON.stringify(params, null, 2)}</code></pre></dd></div>
    <div><dt>Response</dt><dd><pre class="language-html"><code class="language-html">${escapeHtml(body)}</code></pre></dd></div>
  </dl>`;
    document.getElementById("server_view").insertAdjacentHTML("afterbegin", bodyDiv);
    showTimelineEntry(id);
    // Prism.highlightAll();
  }

  function escapeHtml(string) {
    let pre = document.createElement('pre');
    let text = document.createTextNode(string);
    pre.appendChild(text);
    return pre.innerHTML;
  }
class DetailsForceState extends HTMLElement {
    constructor() {
      super();
      this._observer = new MutationObserver(this._init.bind(this));
    }

    connectedCallback() {
      if (this.children.length) {
        this._init();
      }
      this._observer.observe(this, { childList: true });
    }

    _init() {
      let details = this.querySelector(":scope details");
      if (!details) {
        return;
      }

      let forceOpen = window.getComputedStyle(details).getPropertyValue("--details-force-closed");

      function forceState(isOpen) {
        if (isOpen) {
          details.setAttribute("open", "open");
        } else {
          details.removeAttribute("open");
        }
      }

      if (forceOpen && "matchMedia" in window) {
        let mm1 = window.matchMedia(forceOpen);
        forceState(!mm1.matches);
        mm1.addListener(function (e) {
          forceState(!e.matches);
        });
      }
    }
  }

  if ("customElements" in window) {
    customElements.define("details-force-state", DetailsForceState);
  }</script>
</head>


<body>
  <a href="#main">Skip to content</a>
  <div class="with-sidebar">
    <header>
      <nav aria-label="Site">
  <ul role="list">
    <li><a href="/alpine-ajax/" aria-current="">Alpine AJAX</a></li>
    <li>
      <a href="/alpine-ajax/reference" aria-current="">Reference</a>
      
    </li>
    <li>
      <a href="/alpine-ajax/examples" aria-current="">Examples</a>
      <details-force-state>
        <details>
          <summary>Jump to...</summary>
          <ol>
            <li><a href="/alpine-ajax/examples/toggle-button" aria-current="">Toggle Button</a></li>
            <li><a href="/alpine-ajax/examples/loading" aria-current="">Loading Indicator</a></li>
            <li><a href="/alpine-ajax/examples/inline-edit" aria-current="">Inline Edit</a></li>
            <li><a href="/alpine-ajax/examples/delete-row" aria-current="">Delete Row</a></li>
            <li><a href="/alpine-ajax/examples/edit-row" aria-current="page">Edit Row</a></li>
            <li><a href="/alpine-ajax/examples/bulk-update" aria-current="">Bulk Update</a></li>
            <li><a href="/alpine-ajax/examples/instant-search" aria-current="">Instant Search</a></li>
            <li><a href="/alpine-ajax/examples/filterable-content" aria-current="">Filterable Content</a></li>
            <li><a href="/alpine-ajax/examples/inline-validation" aria-current="">Inline Validation</a></li>
            <li><a href="/alpine-ajax/examples/lazy-load" aria-current="">Lazy Load</a></li>
            <li><a href="/alpine-ajax/examples/dialog" aria-current="">Dialog (Modal)</a></li>
            <li><a href="/alpine-ajax/examples/progress-bar" aria-current="">Progress Bar</a></li>
            <li><a href="/alpine-ajax/examples/infinite-scroll" aria-current="">Infinite Scroll</a></li>
            <li><a href="/alpine-ajax/examples/notifications" aria-current="">Notifications</a></li>
            <li><a href="/alpine-ajax/examples/server-events" aria-current="">Server Events</a></li>
            <li><a href="/alpine-ajax/examples/dialog-form" aria-current="">Dialog (Modal) Form</a></li>
          </ol>
        </details>
      </details-force-state>
    </li>
    <li>
      <a href="/alpine-ajax/comparisons" aria-current="">Comparisons</a>
      
    </li>
    <li><a href="https://github.com/imacrayon/alpine-ajax/releases">Changelog</a></li>
    <li><a href="https://github.com/imacrayon/alpine-ajax">GitHub</a></li>
  </ul>
</nav>



    </header>
    <main id="main"><h1 id="edit-row" tabindex="-1">Edit Row <a href="#edit-row" aria-hidden="true" class="direct-link">#</a></h1>

<script src="/alpine-ajax/js/server.js"></script>
<p>This example shows how to implement editable table rows. First let's look at the table:</p>
<pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>table</span><span class="token punctuation">></span></span><br>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>thead</span><span class="token punctuation">></span></span><br>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">></span></span><br>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span> <span class="token attr-name">scope</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>col<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Name<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">></span></span><br>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span> <span class="token attr-name">scope</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>col<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Email<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">></span></span><br>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span> <span class="token attr-name">scope</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>col<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Actions<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">></span></span><br>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span><br>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>thead</span><span class="token punctuation">></span></span><br>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tbody</span><span class="token punctuation">></span></span><br>    ...<br>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tbody</span><span class="token punctuation">></span></span><br><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>table</span><span class="token punctuation">></span></span></code></pre>
<p>Here is the HTML for a table row:</p>
<pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>contact_1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><br>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>Finn Mertins<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span><br>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>fmertins@candykingdom.gov<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span><br>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span><br>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>contact_1_edit<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/contacts/1/edit<span class="token punctuation">"</span></span> <span class="token attr-name">x-target</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>contact_1<span class="token punctuation">"</span></span> <span class="token attr-name">x-focus</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>contact_1_name<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Edit<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span><br>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span><br><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span></code></pre>
<p>Notice the &quot;Edit&quot; link in the table row is targeting its own row, this will tell the request triggered by the &quot;Edit&quot; link to replace the entire table row. Additionally, we've added an <code>id</code> and <code>x-focus</code> attribute to the &quot;Edit&quot; link so that we can control keyboard focus and we switch between &quot;view&quot; and &quot;edit&quot; modes for this table row.</p>
<p>Finally, here is the &quot;edit mode&quot; state that will replace a row:</p>
<pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>contact_1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><br>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">aria-label</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Name<span class="token punctuation">"</span></span> <span class="token attr-name">form</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>contact_1_form<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>name<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>contact_1_name<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Finn Mertins<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span><br>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">aria-label</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Email<span class="token punctuation">"</span></span> <span class="token attr-name">form</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>contact_1_form<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>email<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>email<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>contact_1_email<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>fmertins@candykingdom.gov<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><br>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span><br>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span><br>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">x-target</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>contact_1<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/contacts<span class="token punctuation">"</span></span> <span class="token attr-name">x-focus</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>contact_1_edit<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Cancel<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span><br>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">x-target</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>contact_1<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>contact_1_form<span class="token punctuation">"</span></span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>put<span class="token punctuation">"</span></span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/contacts/1<span class="token punctuation">"</span></span> <span class="token attr-name">x-focus</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>contact_1_edit<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><br>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span><span class="token punctuation">></span></span>Save<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span><br>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span><br>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span><br><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span></code></pre>
<p>Note the matching <code>id=&quot;contact_1&quot;</code> which is used to match the table row being replaced. We've also added <code>x-focus</code> to the &quot;Cancel&quot; link and edit form so that keyboard focus is returned to the &quot;Edit&quot; button in &quot;view mode&quot; when we cancel or submit changes.</p>
<p>Try using the keyboard in the following demo and notice how keyboard focus is maintained as your navigate between &quot;view mode&quot; and &quot;edit mode&quot; in each row.</p>
<script>
  let database = function () {
    let data = [
      { id: 1, name: "Finn Mertins", email: "fmertins@candykingdom.gov", status: "Active" },
      { id: 2, name: "Jake the Dog", email: "jake@candykingdom.gov", status: "Active" },
      { id: 3, name: "BMO", email: "bmo@mo.co", status: "Active" },
      { id: 4, name: "Marceline", email: "marceline@vampirequeen.me", status: "Inactive" }
    ];
    return {
      find: (id) => data.find(contact => contact.id === parseInt(id)),
      update: (id, changes) => {
        let index = data.findIndex(contact => contact.id === parseInt(id))
        if (index !== -1) {
          data[index] = Object.assign(data[index], changes)
        }
      },
      all: () => data,
    }
  }()

  window.route('GET', '/contacts', () => view(database.all()))
  database.all().forEach(contact => {
    window.route('GET', `/contacts/${contact.id}/edit`, () => edit(database.all()))
    window.route('PUT', `/contacts/${contact.id}`, (input) => {
      database.update(contact.id, input)

      return view(database.all())
    })
  })

  example('/contacts')

  function view(contacts) {
    let rows = contacts.map(contact => `<tr id="contact_${contact.id}">
  <td>${contact.name}</td>
  <td>${contact.email}</td>
  <td><a href="/contacts/${contact.id}/edit" x-target="contact_${contact.id}" id="contact_${contact.id}_edit" x-focus="contact_${contact.id}_name">Edit</a></td>
</tr>`).join('\n')
    return table(rows)
  }

  function edit(contacts) {
    let rows = contacts.map(contact => `<tr id="contact_${contact.id}">
  <td><input aria-label="Name" form="contact_${contact.id}_form" name="name" id="contact_${contact.id}_name" value="${contact.name}"></td>
  <td><input aria-label="Email" form="contact_${contact.id}_form" name="email" id="contact_${contact.id}_email" value="${contact.email}"></td>
  <td>
      <a x-target="contact_${contact.id}" href="/contacts" x-focus="contact_${contact.id}_edit">Cancel</a>
      <form x-target="contact_${contact.id}" id="contact_${contact.id}_form" method="put" action="/contacts/${contact.id}" x-focus="contact_${contact.id}_edit" style="margin:0;display:inline-flex;">
        <button>Save</button>
      </form>
  </td>
</tr>`).join('\n')
    return table(rows)
  }

  function table(rows) {
    return `<table>
  <thead>
    <tr>
      <th scope="col">Name</th>
      <th scope="col">Email</th>
      <th scope="col" width="130">Action</th>
    </tr>
  </thead>
  <tbody>
    ${rows}
  </tbody>
</table>`
  }
</script>

<h2 id="demo" tabindex="-1">Demo <a href="#demo" aria-hidden="true" class="direct-link">#</a></h2>

<noscript>
  <strong>This demo would normally function without JavaScript enabled</strong>. However, this website is static and
  mocks HTTP responses using JavaScript instead of interacting with a real server, so you will need to enable
  JavaScript to view this demo.
</noscript>
<div id="example"></div>
<details id="server_info">
  <summary>Server Requests (<span id="server_request_count"></span>)</summary>
  <div id="server_activity">
    <div>
      <ol id="server_timeline" reversed="">
      </ol>
    </div>
    <div id="server_view">
    </div>
  </div>
</details>




</main>
  </div>



</body>
</html>