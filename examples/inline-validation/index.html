<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Inline Validation | Alpine AJAX</title>
  <meta name="description" content="Alpine AJAX">
  <meta name="generator" content="Eleventy v2.0.1">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prism-themes@1.9.0/themes/prism-a11y-dark.min.css">
  <link rel="stylesheet" href="/css/main.css?id=3">
  <style>#example {
    overflow-x: auto;
    padding: 1rem;
    margin: -1rem;
    margin-bottom: calc(40vh + 4rem);
    max-width: 100%;
  }

  #server_info {
    position: fixed;
    bottom: 0;
    right: .5rem;
    left: .5rem;
    border-bottom-right-radius: 0;
    border-bottom-left-radius: 0;
    box-shadow: 0 10px 15px -3px var(--shadow), 0 4px 6px -4px var(--shadow);
    padding: .88rem 1rem;
    margin: 0;
  }

  #server_activity {
    display: flex;
    flex-wrap: wrap;
    gap: 2rem;
    height: 40vh;
    overflow: scroll;
  }

  #server_activity> :first-child {
    flex-grow: 1;
    position: relative;
  }

  #server_activity> :last-child {
    flex-basis: 0;
    flex-grow: 999;
    min-inline-size: 50%;
    margin-top: .4rem;
  }

  #server_activity [aria-current="step"] button {
    font-weight: 700;
  }

  #server_activity dl>div:not(:first-child) dd::before {
    content: '';
  }

  #server_activity dl>div:first-child {
    display: flex;
    gap: .4rem;
    align-items: center;
    margin-bottom: .4rem;
  }

  #server_timeline {
    position: sticky;
    top: 0;
  }

  #server_timeline button {
    padding: 0;
    border: none;
    background: transparent;
    color: var(--nc-lk-1);
    text-decoration: underline;
  }

  #server_timeline button:hover,
  #server_timeline button:focus {
    color: var(--nc-lk-2);
  }</style>
  
  <script defer src="/js/main.js"></script>
  <script>function example(action) {
    let requestCount = 1
    document.addEventListener('DOMContentLoaded', () => {
      window.fetch(action)
        .then(response => response.text())
        .then(html => document.getElementById('example').innerHTML = html)
    })
    document.body.addEventListener('server:response', (event) => {
      logActivity(requestCount++, event.detail.method, event.detail.url, event.detail.data, event.detail.body)
    })
  }

  function showTimelineEntry(id) {
    Array.from(document.getElementById("server_view").children).forEach(child => {
      if (child.id == id) {
        child.removeAttribute('hidden');
      } else {
        child.setAttribute('hidden', true);
      }
    })
    Array.from(document.getElementById("server_timeline").children).forEach(child => {
      if (child.id == id + "-link") {
        child.setAttribute('aria-current', 'step');
      } else {
        child.removeAttribute('aria-current');
      }
    })
  }

  function logActivity(id, method, url, params, body) {
    document.getElementById("server_request_count").innerHTML = id
    document.getElementById("server_timeline").insertAdjacentHTML("afterbegin", `<li id="${id}-link"><button onclick="showTimelineEntry('${id}')" style="cursor: pointer">${method} ${url}</a></li>`);
    let bodyDiv = `<dl id="${id}">
    <div><dt>Request</dt><dd>${method} ${url}</dd></div>
    <div><dt>Parameters</dt><dd><pre class="language-json"><code class="language-json">${JSON.stringify(params, null, 2)}</code></pre></dd></div>
    <div><dt>Response</dt><dd><pre class="language-html"><code class="language-html">${escapeHtml(body)}</code></pre></dd></div>
  </dl>`;
    document.getElementById("server_view").insertAdjacentHTML("afterbegin", bodyDiv);
    showTimelineEntry(id);
    // Prism.highlightAll();
  }

  function escapeHtml(string) {
    let pre = document.createElement('pre');
    let text = document.createTextNode(string);
    pre.appendChild(text);
    return pre.innerHTML;
  }
class DetailsForceState extends HTMLElement {
    constructor() {
      super();
      this._observer = new MutationObserver(this._init.bind(this));
    }

    connectedCallback() {
      if (this.children.length) {
        this._init();
      }
      this._observer.observe(this, { childList: true });
    }

    _init() {
      let details = this.querySelector(":scope details");
      if (!details) {
        return;
      }

      let forceOpen = window.getComputedStyle(details).getPropertyValue("--details-force-closed");

      function forceState(isOpen) {
        if (isOpen) {
          details.setAttribute("open", "open");
        } else {
          details.removeAttribute("open");
        }
      }

      if (forceOpen && "matchMedia" in window) {
        let mm1 = window.matchMedia(forceOpen);
        forceState(!mm1.matches);
        mm1.addListener(function (e) {
          forceState(!e.matches);
        });
      }
    }
  }

  if ("customElements" in window) {
    customElements.define("details-force-state", DetailsForceState);
  }</script>
</head>


<body>
  <a href="#main">Skip to content</a>
  <div class="with-sidebar">
    <header>
      <nav aria-label="Site">
  <ul role="list">
    <li><a href="/" aria-current>Alpine AJAX</a></li>
    <li>
      <a href="/reference" aria-current>Reference</a>
      
    </li>
    <li>
      <a href="/examples" aria-current>Examples</a>
      <details-force-state>
        <details>
          <summary>Jump to...</summary>
          <ol>
            <li><a href="/examples/toggle-button" aria-current>Toggle Button</a></li>
            <li><a href="/examples/loading" aria-current>Loading Indicator</a></li>
            <li><a href="/examples/inline-edit" aria-current>Inline Edit</a></li>
            <li><a href="/examples/delete-row" aria-current>Delete Row</a></li>
            <li><a href="/examples/edit-row" aria-current>Edit Row</a></li>
            <li><a href="/examples/bulk-update" aria-current>Bulk Update</a></li>
            <li><a href="/examples/instant-search" aria-current>Instant Search</a></li>
            <li><a href="/examples/filterable-content" aria-current>Filterable Content</a></li>
            <li><a href="/examples/inline-validation" aria-current="page">Inline Validation</a></li>
            <li><a href="/examples/lazy-load" aria-current>Lazy Load</a></li>
            <li><a href="/examples/dialog" aria-current>Dialog (Modal)</a></li>
            <li><a href="/examples/progress-bar" aria-current>Progress Bar</a></li>
            <li><a href="/examples/infinite-scroll" aria-current>Infinite Scroll</a></li>
            <li><a href="/examples/notifications" aria-current>Notifications</a></li>
            <li><a href="/examples/server-events" aria-current>Server Events</a></li>
            <li><a href="/examples/dialog-form" aria-current>Dialog (Modal) Form</a></li>
          </ol>
        </details>
      </details-force-state>
    </li>
    <li>
      <a href="/comparisons" aria-current>Comparisons</a>
      
    </li>
    <li><a href="https://github.com/imacrayon/alpine-ajax/releases">Changelog</a></li>
    <li><a href="https://github.com/imacrayon/alpine-ajax">GitHub</a></li>
  </ul>
</nav>



    </header>
    <main id="main"><h1 id="inline-validation" tabindex="-1">Inline Validation <a href="#inline-validation" aria-hidden="true" class="direct-link">#</a></h1>

<script src="/js/server.js"></script>
<p>This example shows how to do inline field validation. In this example we'll create an email field that can issue requests to our server with an email to be validated, the server will then render validation messages that will be inserted into the DOM.</p>
<p>We start with this form:</p>
<pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">x-data</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>{ email: '' }<span class="token punctuation">"</span></span> <span class="token attr-name">aria-label</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Register<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><br>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>email_field<span class="token punctuation">"</span></span> <span class="token attr-name">@change</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>$ajax('/validate-email', {<br>    method: 'post',<br>    body: { email },<br>  })<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><br>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>email<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Email<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">></span></span><br>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>email<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>email<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>email<span class="token punctuation">"</span></span> <span class="token attr-name">x-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>email<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><br>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><br>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><br>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>name<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Name<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">></span></span><br>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>name<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>name<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><br>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><br>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span><span class="token punctuation">></span></span>Submit<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span><br><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span></code></pre>
<p>Note that the first <code>div</code> in the form has an <code>id</code> of <code>email_field</code> and it is listening for the <code>change</code> event. When the change event occurs the field will issue a <code>POST</code> request to the <code>/validate-email</code> endpoint.</p>
<p>The server will return the same form markup containing a new validation error message:</p>
<pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">x-data</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>{ email: '' }<span class="token punctuation">"</span></span> <span class="token attr-name">aria-label</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Register<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><br>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>email_field<span class="token punctuation">"</span></span> <span class="token attr-name">@change</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>$ajax('/validate-email', {<br>    method: 'post',<br>    body: { email },<br>  })<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><br>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>email<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Email<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">></span></span><br>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>email_error<span class="token punctuation">"</span></span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">color</span><span class="token punctuation">:</span>#cc0000</span><span class="token punctuation">"</span></span></span><span class="token punctuation">></span></span>The email is already taken.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><br>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>email<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>email<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>email<span class="token punctuation">"</span></span> <span class="token attr-name">x-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>email<span class="token punctuation">"</span></span> <span class="token attr-name">aria-describedby</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>email_error<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><br>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><br>  <span class="token comment">&lt;!-- Omitting the rest of the form for brevity --></span><br><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span></code></pre>
<p>Below is a working demo of this example. Any email input without an &quot;@&quot; is considered invalid and the only email that is accepted is <strong><a href="mailto:test@example.com">test@example.com</a></strong>.</p>
<style>
  label {
    display: block;
  }
</style>
<script>

  window.route('GET', '/register', () => view())
  window.route('POST', '/validate-email', (input) => {
    if (input.email === 'test@example.com') {
      return view()
    } else if (input.email.includes('@')) {
      return view('The email is already taken.')
    }

    return view('The email field is invalid.')
  })

  example('/register')

  function view(message = '') {
    message = message ? `<div id="email_error" style="color:#cc0000">${message}</div>` : ''
    return `<form x-data="{ email: '' }" aria-label="Register">
  <div id="email_field" @change="$ajax('/validate-email', {
    method: 'post',
    body: { email },
  })">
    <label for="email">Email</label>
    ${message}
    <input type="email" name="email" id="email" x-model="email"${message ? ' aria-describedby="email_error"' : ''}>
  </div>
  <div>
    <label for="name">Name</label>
    <input name="name" id="name">
  </div>
  <button>Submit</button>
</form>`
  }
</script>

<h2 id="demo" tabindex="-1">Demo <a href="#demo" aria-hidden="true" class="direct-link">#</a></h2>

<noscript>
  <strong>This demo would normally function without JavaScript enabled</strong>. However, this website is static and
  mocks HTTP responses using JavaScript instead of interacting with a real server, so you will need to enable
  JavaScript to view this demo.
</noscript>
<div id="example"></div>
<details id="server_info">
  <summary>Server Requests (<span id="server_request_count"></span>)</summary>
  <div id="server_activity">
    <div>
      <ol id="server_timeline" reversed>
      </ol>
    </div>
    <div id="server_view">
    </div>
  </div>
</details>




</main>
  </div>



</body>
</html>